<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>wordcloud2.js - tag cloud/Wordle presentation on HTML5 canvas element</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">
  <!-- Le styles -->
  <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css" rel="stylesheet">
  <link href="//fonts.googleapis.com/css?family=Finger+Paint" id="link-webfont" rel="stylesheet">
  <style>
  @media (min-width: 980px) {
    body { padding-top: 60px; }
  }
  #canvas-container {
    overflow-x: auto;
    overflow-y: visible;
  }
  #canvas {
    display: block;
    margin: 20px auto;
    max-height: 100%;
  }
  textarea {
    height: 20em;
  }
  #config-option {
    font-family: monospace;
  }
  select { width: 100%; }

  #loading { -webkit-animation: blink 2s infinite; }
  @-webkit-keyframes blink {
    0% { opacity: 1; }
    100% { opacity: 0; }
  }
  </style>
  <script type="text/javascript">
    if (window.location.hostname === 'timdream.org') {
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-4623408-2']);
      _gaq.push(['_trackPageview']);
    }

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>
<body>
  <div class="navbar navbar-fixed-top navbar-inverse">
    <div class="navbar-inner">
      <div class="container">
        <a class="brand" href="./">wordcloud2.js</a>
        <ul class="nav">
          <li class="active"><a href="./">Demo</a></li>
          <li><a href="https://github.com/timdream/wordcloud2.js">Code</a></li>
          <li><a href="https://github.com/timdream/wordcloud2.js/blob/master/README.md">README</a></li>
          <li><a href="https://github.com/timdream/wordcloud2.js/blob/master/API.md">API</a></li>
          <li><a href="http://timdream.org/">timdream</a></li>
        </ul>
      </div>
    </div>
  </div>
  <div class="container">
    <p class="lead"><strong>wordcloud2.js</strong>, tag cloud/Wordle presentation on HTML5 canvas element</p>
    <div id="not-supported" class="alert" hidden>
      <strong>Your browser is not supported.</strong>
    </div>
    <form id="form" method="get" action="">
      <div class="row">
        <div class="span12" id="canvas-container">
          <canvas id="canvas"></canvas>
        </div>
        <div class="span6">
          <button class="btn btn-primary" type="submit">Run</button>
          <a class="btn" id="btn-save" href="#" download="wordcloud.png">Save</a>
          <span id="loading" hidden>......</span>
        </div>
        <div class="span6">
          <select id="examples" class="">
            <option selected>Examples</option>
            <option value="love">Love of the world</option>
            <option value="web-tech">Web Technologies</option>
            <option value="quick-fox">The quick brown fox</option>
            <option value="les-miz">Les Misérables</option>
            <option value="red-chamber" lang="zh-tw">紅樓夢</option>
          </select>
        </div>
      </div>
      <div class="tabbable">
        <ul class="nav nav-tabs">
          <li class="active"><a href="#tab-list" data-toggle="tab">List</a></li>
          <li><a href="#tab-config" data-toggle="tab">Configuration</a></li>
          <li><a href="#tab-dim" data-toggle="tab">Dimension</a></li>
          <li><a href="#tab-webfont" data-toggle="tab">Web Font</a></li>
        </ul>
        <div class="tab-content">
          <div class="tab-pane active" id="tab-list">
            <textarea id="input-list" placeholder="Put your list here." rows="2" cols="30" class="span12"></textarea>
          </div>
          <div class="tab-pane" id="tab-config">
            <label>Options as a literal Javascript object</label>
            <textarea id="config-option" placeholder="Put your literal option object here." rows="2" cols="30" class="span12"></textarea>
            <span class="help-block">See <a href="https://github.com/timdream/wordcloud2.js/blob/master/API.md">API</a> document for available options.</span>
          </div>
          <div class="tab-pane" id="tab-dim">
            <label for="config-width">Width</label>
            <div class="input-append">
              <input type="number" id="config-width" class="input-small" min="1">
              <span class="add-on">px</span>
            </div>
            <span class="help-block">Leave blank to use page width.</span>
            <label for="config-height">Height</label>
            <div class="input-append">
              <input type="number" id="config-height" class="input-small" min="1">
              <span class="add-on">px</span>
            </div>
            <span class="help-block">Leave blank to use 0.65x of the width.</span>
          </div>
          <div class="tab-pane" id="tab-webfont">
            <label for="config-css">Extra Web Font CSS</label>
            <input type="url" id="config-css" size="40" class="input-xxlarge" placeholder="https://fonts.googleapis.com/css?family=Libre+Baskerville:700" value="https://fonts.googleapis.com/css?family=Finger+Paint">
            <span class="help-block">Find your favorite font on <a href="https://www.google.com/webfonts">Google Web Fonts</a>. Re-run if the font didn't load in time.</span>
         </div>
        </div>
      </div>
    </form>
  </div>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/bootstrap.min.js"></script>
  <script src="./src/wordcloud2.js"></script>
  <script>
  'use strict';

  jQuery(function ($) {
    var $form = $('#form');
    var $canvas = $('#canvas');
    var $canvasContainer = $('#canvas-container');
    var $loading = $('#loading');

    var $list = $('#input-list');
    var $options = $('#config-option');
    var $width = $('#config-width');
    var $height = $('#config-height');
    var $css = $('#config-css');
    var $webfontLink = $('#link-webfont');

    if (!WordCloud.isSupported) {
      $('#not-supported').prop('hidden', false);
      $form.find('textarea, input, select, button').prop('disabled', true);
      return;
    }

    $canvas.on('wordcloudstop', function wordcloudstopped(evt) {
      $loading.prop('hidden', true);
    });

    $form.on('submit', function formSubmit(evt) {
      evt.preventDefault();

      run();
    });

    $('#btn-save').on('click', function save(evt) {
      var url = $canvas[0].toDataURL();
      if ('download' in document.createElement('a')) {
        this.href = url;
      } else {
        evt.preventDefault();
        alert('Please right click and choose "Save As..." to save the generated image.');
        window.open(url, '_blank', 'width=500,height=300,menubar=yes');
      }

    });

    var $examples = $('#examples');
    $examples.on('change', function loadExample(evt) {
      loadExampleData(this.value);

      $examples[0].selectedIndex = 0;
      $form.submit();
      $examples.blur();
    });

    var run = function run() {
      $loading.prop('hidden', false);

      // Load web font
      $webfontLink.prop('href', $css.val());

      // Set the width and height
      $canvas.attr('width',
          $width.val() ? $width.val() : $('#canvas-container').width());
      $canvas.attr('height',
          $height.val() ? $height.val() : $canvas.attr('width') * 0.65);

      // Set the options object
      var options = {};
      if ($options.val()) {
        options = (function evalOptions() {
          try {
            return eval('(' + $options.val() + ')');
          } catch (e) {
            return {};
          }
        })();
      }

      // Put the word list into options
      if ($list.val()) {
        var wordList = [];
        $.each($list.val().split('\n'), function each(i, line) {
          if (!$.trim(line))
            return;

          var lineArr = line.split(' ');
          var count = parseFloat(lineArr.shift()) || 0;
          wordList.push([lineArr.join(' '), count]);
        });
        options.wordList = wordList;
      }

      // All set, call the WordCloud();
      WordCloud($canvas[0], options);
    };

    var loadExampleData = function loadExampleData(name) {
      var example = examples[name];

      $options.val(example.option || '');
      $list.val(example.list || '');
      $css.val(example.fontCSS || '');
      $width.val(example.width || '');
      $height.val(example.height || '');
    };

    loadExampleData('love');
    run();
  });

  var examples = {
    'web-tech': {
      list: '26 Web Technologies\n20 HTML\n20 <canvas>\n' +
            '15 CSS\n15 JavaScript\n12 Document Object Model\n12 <audio>\n12 <video>\n12 Web Workers\n12 XMLHttpRequest\n12 SVG\n' +
            '9 JSON.parse()\n9 Geolocation\n9 data attribute\n9 transform\n9 transition\n9 animation\n' +
            '7 setTimeout\n7 @font-face\n7 Typed Arrays\n7 FileReader API\n7 FormData\n7 IndexedDB\n' +
            '7 getUserMedia()\n7 postMassage()\n7 CORS\n6 strict mode\n6 calc()\n6 supports()\n' +
            '6 media queries\n6 full screen\n6 notification\n6 orientation\n6 requestAnimationFrame\n' +
            '5 border-radius\n5 box-sizing\n5 rgba()\n5 text-shadow\n5 box-shadow\n5 flexbox\n5 viewpoint',
      option: '{\n' +
              '  gridSize: 18,\n' +
              '  weightFactor: 3,\n' +
              '  fontFamily: \'Finger Paint, cursive, sans-serif\',\n' +
              '  wordColor: \'#f0f0c0\',\n' +
              '  backgroundColor: \'#001f00\'\n' +
              '}',
      fontCSS: 'https://fonts.googleapis.com/css?family=Finger+Paint'
    },
    'les-miz': {
      list: '30 Les Misérables\n20 Victor Hugo\n15 Jean Valjean\n15 Javert\n15 Fantine\n' +
            '15 Cosette\n12 Éponine\n12 Marius\n12 Enjolras\n10 Thénardiers\n10 Gavroche\n' +
            '10 Bishop Myriel\n10 Patron-Minette\n10 God\n8 ABC Café\n8 Paris\n8 Digne\n' +
            '8 Elephant of the Bastille\n5 silverware\n5 Bagne of Toulon\n5 loaf of bread\n' +
            '5 Rue Plumet\n5 revolution\n5 barricade\n4 sewers\n4 Fex urbis lex orbis',
      option: '{\n' +
            '  gridSize: 18,\n' +
            '  weightFactor: 3,\n' +
            '  fontFamily: \'Average, Times, serif\',\n' +
            '  wordColor: function() {\n' +
            '    return ([\'#d0d0d0\', \'#e11\', \'#44f\'])[Math.floor(Math.random() * 3)]\n' +
            '  },\n' +
            '  backgroundColor: \'#333\'\n' +
            '}',
      fontCSS: 'https://fonts.googleapis.com/css?family=Average'
    },
    'red-chamber': {
      list: '6 紅樓夢\n3 賈寶玉\n3 林黛玉\n3 薛寶釵\n3 王熙鳳\n3 李紈\n3 賈元春\n3 賈迎春\n' +
            '3 賈探春\n3 賈惜春\n3 秦可卿\n3 賈巧姐\n3 史湘雲\n3 妙玉\n2 賈政\n2 賈赦\n' +
            '2 賈璉\n2 賈珍\n2 賈環\n2 賈母\n2 王夫人\n2 薛姨媽\n2 尤氏\n2 平兒\n2 鴛鴦\n' +
            '2 襲人\n2 晴雯\n2 香菱\n2 紫鵑\n2 麝月\n2 小紅\n2 金釧\n2 甄士隱\n2 賈雨村',
      option: '{\n' +
              '  gridSize: 8,\n' +
              '  weightFactor: 16,\n' +
              '  fontFamily: \'Hiragino Mincho Pro, serif\',\n' +
              '  wordColor: \'random-dark\',\n' +
              '  backgroundColor: \'#f0f0f0\',\n' +
              '  rotateRatio: 0\n' +
              '}'
    },
    'quick-fox': {
      list: '2 The\n2 quick\n3 brown\n5 fox\n3 jumps\n3 over\n3.5 the\n3 lazy\n6 dog\n',
      option: '{\n' +
              '  gridSize: 16,\n' +
              '  weightFactor: 16,\n' +
              '  center: [90, 0],\n' +
              '  fontFamily: \'Times, serif\',\n' +
              '  wordColor: \'random-light\',\n' +
              '  backgroundColor: \'#000\',\n' +
              '  shuffle: false,\n' +
              '  rotateRatio: 0\n' +
              '}',
      width: 180,
      height: 480
    },
    'love' : {
      list: (function generateLoveList() {
        var list = ['12 Love'];
        var nums = [5, 4, 3, 2, 2];
        // This list of the word "Love" in language of the world was taken from
        // the Language links of entry "Love" in English Wikipedia, with duplicate
        // spelling removed.
        var words = ('Liebe,ፍቅር,Lufu,حب,Aimor,Amor,Heyran,ভালোবাসা,Каханне,Любоў,Любов,བརྩེ་དུང་།,' +
          'Ljubav,Karantez,Юрату,Láska,Amore,Cariad,Kærlighed,Armastus,Αγάπη,Amo,Amol,Maitasun,' +
          'عشق,Pyar,Amour,Leafde,Gràdh,愛,爱,પ્રેમ,사랑,Սեր,Ihunanya,Cinta,ᑕᑯᑦᓱᒍᓱᑉᐳᖅ,Ást,אהבה,' +
          'ಪ್ರೀತಿ,სიყვარული,Махаббат,Pendo,Сүйүү,Mīlestība,Meilė,Leefde,Bolingo,Szerelem,' +
          'Љубов,സ്നേഹം,Imħabba,प्रेम,Ái,Хайр,အချစ်,Tlazohtiliztli,Liefde,माया,मतिना,' +
          'Kjærlighet,Kjærleik,ପ୍ରେମ,Sevgi,ਪਿਆਰ,پیار,Miłość,Leevde,Dragoste,' +
          'Khuyay,Любовь,Таптал,Dashuria,Amuri,ආදරය,Ljubezen,Jaceyl,خۆشەویستی,Љубав,Rakkaus,' +
          'Kärlek,Pag-ibig,காதல்,ప్రేమ,ความรัก,Ишқ,Aşk,محبت,Tình yêu,Higugma,ליבע').split(',');

        nums.forEach(function(n) {
          words.forEach(function(w) {
            list.push(n + ' ' + w);
          });
        });

        return list.join('\n');
      })(),
      option: '{\n' +
        '  gridSize: Math.round(16 * $(\'#canvas\').prop(\'width\') / 1024),\n' +
        '  weightFactor: function (size) {\n' +
        '    return Math.pow(size, 2.3) * $(\'#canvas\').prop(\'width\') / 1024;\n' +
        '  },\n' +
        '  fontFamily: \'serif\',\n' +
        '  wordColor: function (word, weight) {\n' +
        '    return (weight === 12) ? \'#f02222\' : \'#c09292\';\n' +
        '  },\n' +
        '  rotateRatio: 0,\n' +
        '  backgroundColor: \'#ffe0e0\'\n' +
        '}'
    }
  };
  </script>
</body>
</html>
